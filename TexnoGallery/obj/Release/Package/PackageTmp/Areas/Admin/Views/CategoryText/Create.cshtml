@model TexnoGallery.Models.Category

@{
    ViewBag.Title = "Create";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
}
@section adminCss{

    <link href="~/Areas/Admin/assets/css/typeahead.css" rel="stylesheet" />
}
<div class="col-md-12">
    <h2>Create</h2>

    <form id="newSbCat" method="post">
        @Html.AntiForgeryToken()

        <div class="form-horizontal">
            <h4>Category</h4>
            <hr />
            @*@if (ViewBag.Error.Length!="")
        {
            <span class="alert alert-danger">@ViewBag.Error</span>
        }*@
            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
            <div class="form-group">
                @Html.Label("Category", htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-md-10">

                    @Html.EditorFor(model => model.Name, new { htmlAttributes = new { @class = "form-control", @id = "catId" } })
                    @Html.ValidationMessageFor(model => model.Name, "", new { @class = "text-danger" })

                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(model => model.Icons, htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-md-10">
                    @Html.EditorFor(model => model.Icons, new { htmlAttributes = new { id = "iconForm", @class = "form-control d-none" } })
                    @Html.ValidationMessageFor(model => model.Icons, "", new { @class = "text-danger" })
                    <div class="catIcon">
                        <i class="fas fa-desktop"></i>
                        <i class="fas fa-laptop"></i>
                        <i class="fas fa-headphones"></i>
                        <i class="fas fa-print"></i>
                        <i class="fas fa-plus"></i>
                        <i class="fas fa-mouse-pointer"></i>
                        <i class="fas fa-cogs"></i>
                        <i class="fas fa-hdd"></i>
                        <i class="fas fa-keyboard"></i>
                        <i class="fas fa-headset"></i>
                        <i class="fas fa-memory"></i>
                        <i class="fas fa-microchip"></i>
                        <i class="fas fa-plug"></i>
                        <i class="fas fa-server"></i>
                        <i class="fas fa-sd-card"></i>
                        <i class="fas fa-shield-alt"></i>
                        <i class="fas fa-wrench"></i>
                    </div>
                </div>
            </div>
            @*<div class="form-group">
            @Html.Label("Sub Category", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <div class="tt-container">
                    <input  id="subcategory" name="subcategory" class="form-control" type="text" />
                </div>
            </div>
        </div>
        <div class="col-md-5">
            <ul style="list-style:circle" id="subcategories" class="list-group mb-2">
            </ul>

        </div>*@
            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <input type="submit" value="Create" class="btn btn-warning" />
                </div>
            </div>
        </div>
    </form>

    <div>
        @Html.ActionLink("Back to List", "Index")
    </div>
</div>
@section AdminJS{

    @*<script src="~/Scripts/typeahead.bundle.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            var vm = {
                Id: [],
                Category:[]
            };

            var subcategory = new Bloodhound({
                datumTokenizer: Bloodhound.tokenizers.obj.whitespace('Name'),
                queryTokenizer: Bloodhound.tokenizers.whitespace,
                remote: {
                    url: '/api/subcategory?query=%QUERY',
                    wildcard: '%QUERY'
                }

            });


            $('#subcategory').typeahead({
                minLength: 3,
                hint: true,
                highlight: true,

            }, {
                    name: 'subcategory',
                    display: 'Name',
                    source:subcategory

                }).on("typeahead:select", function (e, subcategory) {
                    $("#subcategories").append("<li class='list-group-item'>" + subcategory.Name + "</li>")
                    $("#subcategory").typeahead("val", "");
                    vm.Id.push(subcategory.Id)
                });

            $("#newSbCat").submit(function (e) {
                e.preventDefault();
                vm.Category.push($("#catId").val())
                $.ajax({
                    url: "/api/subcategory",
                    method: "post",
                    data: vm
    
                })
                    .done(function () {
                        console.log("done")

                    })
                    .fail(function () {
                        console.log("false")

                    })
            })
        })
        
    </script>*@
}